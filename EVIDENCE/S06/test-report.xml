<?xml version="1.0" encoding="utf-8"?><testsuites><testsuite name="pytest" errors="0" failures="1" skipped="0" tests="17" time="0.299" timestamp="2025-11-05T17:28:37.212528" hostname="MacBook-Pro-Daniil.local"><testcase classname="tests.test_auth" name="test_auth_required_on_create" time="0.011" /><testcase classname="tests.test_auth" name="test_create_with_token" time="0.007" /><testcase classname="tests.test_crud" name="test_crud_happy_path" time="0.016" /><testcase classname="tests.test_errors" name="test_404_envelope" time="0.002" /><testcase classname="tests.test_health" name="test_health_ok" time="0.002" /><testcase classname="tests.test_internal_error" name="test_internal_error_is_sanitized" time="0.002"><failure message="RuntimeError: boom: sensitive details">+ Exception Group Traceback (most recent call last):
  |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 77, in collapse_excgroups
  |     yield
  |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 341, in from_call
    |     result: Optional[TResult] = func()
    |                                 ~~~~^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 241, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/threadexception.py", line 87, in pytest_runtest_call
    |     yield from thread_exception_runtest_hook()
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/threadexception.py", line 63, in thread_exception_runtest_hook
    |     yield
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/unraisableexception.py", line 90, in pytest_runtest_call
    |     yield from unraisable_exception_runtest_hook()
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/unraisableexception.py", line 65, in unraisable_exception_runtest_hook
    |     yield
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield from self._runtest_for(item, "call")
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 833, in _runtest_for
    |     yield
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 878, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 257, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 183, in pytest_runtest_call
    |     raise e
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 173, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1632, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/_pytest/python.py", line 162, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/tests/test_internal_error.py", line 9, in test_internal_error_is_sanitized
    |     r = client.get("/wishes")
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/testclient.py", line 518, in get
    |     return super().get(
    |            ~~~~~~~~~~~^
    |         url,
    |         ^^^^
    |     ...&lt;6 lines&gt;...
    |         extensions=extensions,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1066, in get
    |     return self.request(
    |            ~~~~~~~~~~~~^
    |         "GET",
    |         ^^^^^^
    |     ...&lt;7 lines&gt;...
    |         extensions=extensions,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/testclient.py", line 488, in request
    |     return super().request(
    |            ~~~~~~~~~~~~~~~^
    |         method,
    |         ^^^^^^^
    |     ...&lt;11 lines&gt;...
    |         extensions=extensions,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/httpx/_client.py", line 837, in request
    |     return self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/httpx/_client.py", line 926, in send
    |     response = self._send_handling_auth(
    |         request,
    |     ...&lt;2 lines&gt;...
    |         history=[],
    |     )
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    |     response = self._send_handling_redirects(
    |         request,
    |         follow_redirects=follow_redirects,
    |         history=history,
    |     )
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    |     response = self._send_single_request(request)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1027, in _send_single_request
    |     response = transport.handle_request(request)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/testclient.py", line 381, in handle_request
    |     raise exc
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/testclient.py", line 378, in handle_request
    |     portal.call(self.app, scope, receive, send)
    |     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/anyio/from_thread.py", line 321, in call
    |     return cast(T_Retval, self.start_task_soon(func, *args).result())
    |                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    |     return self.__get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    |     raise self._exception
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/anyio/from_thread.py", line 252, in _call_func
    |     retval = await retval_or_awaitable
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 187, in __call__
    |     raise exc
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 83, in collapse_excgroups
    |     raise exc
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/app/middlewares.py", line 49, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 163, in call_next
    |     raise app_exc
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 83, in collapse_excgroups
    |     raise exc
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/app/middlewares.py", line 44, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 163, in call_next
    |     raise app_exc
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 83, in collapse_excgroups
    |     raise exc
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/app/middlewares.py", line 17, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 163, in call_next
    |     raise app_exc
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 62, in wrapped_app
    |     raise exc
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 51, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 62, in wrapped_app
    |     raise exc
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 51, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 297, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         dependant=dependant, values=values, is_coroutine=is_coroutine
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/starlette/concurrency.py", line 39, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/anyio/to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    |     return await future
    |            ^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    |     result = context.run(func, *args)
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/app/adapters/http/wishes_router.py", line 37, in list_wishes
    |     return list(repo.list(q=q, purchased=purchased, price_lte=price_lte))
    |                 ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/gurshhh/Desktop/University/3 year/RBPO/course-project-RaikyD/tests/test_internal_error.py", line 5, in boom
    |     raise RuntimeError("boom: sensitive details")
    | RuntimeError: boom: sensitive details
    +------------------------------------

During handling of the above exception, another exception occurred:

client = &lt;starlette.testclient.TestClient object at 0x106161bf0&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x1061618c0&gt;

    def test_internal_error_is_sanitized(client, monkeypatch):
        from app.adapters.db.repository import WishRepository

        def boom(*args, **kwargs):
            raise RuntimeError("boom: sensitive details")

        monkeypatch.setattr(WishRepository, "list", boom)

&gt;       r = client.get("/wishes")

tests/test_internal_error.py:9:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
.venv/lib/python3.13/site-packages/starlette/testclient.py:518: in get
    return super().get(
.venv/lib/python3.13/site-packages/httpx/_client.py:1066: in get
    return self.request(
.venv/lib/python3.13/site-packages/starlette/testclient.py:488: in request
    return super().request(
.venv/lib/python3.13/site-packages/httpx/_client.py:837: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
.venv/lib/python3.13/site-packages/httpx/_client.py:926: in send
    response = self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:954: in _send_handling_auth
    response = self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:991: in _send_handling_redirects
    response = self._send_single_request(request)
.venv/lib/python3.13/site-packages/httpx/_client.py:1027: in _send_single_request
    response = transport.handle_request(request)
.venv/lib/python3.13/site-packages/starlette/testclient.py:381: in handle_request
    raise exc
.venv/lib/python3.13/site-packages/starlette/testclient.py:378: in handle_request
    portal.call(self.app, scope, receive, send)
.venv/lib/python3.13/site-packages/anyio/from_thread.py:321: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py:456: in result
    return self.__get_result()
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
.venv/lib/python3.13/site-packages/anyio/from_thread.py:252: in _call_func
    retval = await retval_or_awaitable
.venv/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:185: in __call__
    with collapse_excgroups():
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:83: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:187: in __call__
    response = await self.dispatch_func(request, call_next)
app/middlewares.py:49: in dispatch
    response: Response = await call_next(request)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:163: in call_next
    raise app_exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:149: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:185: in __call__
    with collapse_excgroups():
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:83: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:187: in __call__
    response = await self.dispatch_func(request, call_next)
app/middlewares.py:44: in dispatch
    return await call_next(request)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:163: in call_next
    raise app_exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:149: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:185: in __call__
    with collapse_excgroups():
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:83: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:187: in __call__
    response = await self.dispatch_func(request, call_next)
app/middlewares.py:17: in dispatch
    response: Response = await call_next(request)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:163: in call_next
    raise app_exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:149: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:62: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:51: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/starlette/routing.py:715: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:735: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:62: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:51: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/starlette/routing.py:73: in app
    response = await f(request)
.venv/lib/python3.13/site-packages/fastapi/routing.py:297: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
.venv/lib/python3.13/site-packages/starlette/concurrency.py:39: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
.venv/lib/python3.13/site-packages/anyio/to_thread.py:56: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:2485: in run_sync_in_worker_thread
    return await future
.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py:976: in run
    result = context.run(func, *args)
app/adapters/http/wishes_router.py:37: in list_wishes
    return list(repo.list(q=q, purchased=purchased, price_lte=price_lte))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

args = (&lt;app.adapters.db.repository.WishRepository object at 0x1061f87c0&gt;,)
kwargs = {'price_lte': None, 'purchased': None, 'q': None}

    def boom(*args, **kwargs):
&gt;       raise RuntimeError("boom: sensitive details")
E       RuntimeError: boom: sensitive details

tests/test_internal_error.py:5: RuntimeError</failure></testcase><testcase classname="tests.test_rate_limit" name="test_rate_limit_get" time="0.005" /><testcase classname="tests.test_security_headers" name="test_security_headers_present_on_health" time="0.002" /><testcase classname="tests.test_security_headers" name="test_security_headers_present_on_api_response" time="0.003" /><testcase classname="tests.test_validation" name="test_invalid_url_rejected" time="0.003" /><testcase classname="tests.test_validation" name="test_long_search_q_rejected" time="0.002" /><testcase classname="tests.test_validation" name="test_notes_max_length" time="0.002" /><testcase classname="tests.test_wishes" name="test_health" time="0.002" /><testcase classname="tests.test_wishes" name="test_create_and_get_wish" time="0.006" /><testcase classname="tests.test_wishes" name="test_list_filters_and_purchase" time="0.020" /><testcase classname="tests.test_wishes" name="test_patch_and_delete" time="0.010" /><testcase classname="tests.test_wishes" name="test_not_found_and_validation" time="0.004" /></testsuite></testsuites>


| Поток/Элемент | Угроза (STRIDE)                      | Риск ID | Контроль/Мера                                                                 | Ссылка на NFR | Проверка/Артефакт |
|---------------|--------------------------------------|---------|-------------------------------------------------------------------------------|---------------|-------------------|
| F1 (Client→API) | S: Spoofing (подмена юзера)        | R1      | JWT на мутирующие ручки; 401/403 без/с плохим токеном                        | NFR-02        | e2e `test_auth_required` |
| F1             | I: Information disclosure           | R2      | Маскирование PII в ошибках; унифицированный error envelope                   | NFR-01        | контракт-тест ошибок |
| F2 (Edge)      | D: Denial of Service                | R3      | Rate limiting 60 req/min/IP; ответы 429                                      | NFR-03        | нагрузочный тест, логи |
| F2             | R: Repudiation (неотследимые ошибки)| R4      | `X-Request-Id` во всех ответах + логирование коррелятора                     | NFR-10        | интеграционный тест |
| F3 (Core)      | T: Tampering (ввод невалидных данных)| R5     | Схемы Pydantic; строгие статусы; минимальные сообщения ошибок                 | NFR-01        | pytest валидации |
| F3             | E: Elevation of Privilege           | R6      | Авторизация по ролям (резерв: только владелец может менять свои wishes)      | -     | e2e ownership tests |
| F4 (DB)        | I: Info disclosure через БД         | R7      | Principle of Least Privilege (только нужные права), параметры запросов       | NFR-07        | код-ревью/линтер |
| F4             | T: Tampering (инъекции)             | R8      | ORM-плейсхолдеры/параметризованные запросы                                   | —             | юнит-тесты репозитория |
| F5 (Errors)    | I: Verbose errors/stack traces      | R9      | Централизованный обработчик ошибок; без стектрейсов в проде                   | NFR-01        | e2e ошибки |
| Элемент: Secrets | I/T: утечка секретов в код         | R10     | .env, GitHub Secrets, `pip-audit`, pre-commit detect-secrets                  | NFR-04, NFR-05| CI-лог |
